# Modeling the Behavior of a Double Pendulum

This repository contains a project for the Computer Applications Course (ME303) at Bogazici University, Mechanical Engineering Department. This project investigates the motion of a double pendulum using the **Runge-Kutta 4th Order (RK4)** method and MATLAB's built-in **ode45** function.

---

## Mathematical Model

The system consists of two bobs with masses m<sub>1</sub> and m<sub>2</sub>. The mass m<sub>1</sub> is connected to a fixed wall with a rigid, massless string of length L<sub>1</sub>. Similarly, the mass m<sub>2</sub> is connected to m<sub>1</sub> with another rigid, massless string of length L<sub>2</sub>. The system is depicted below:

<p align="center">
  <img src="https://github.com/user-attachments/assets/a6096eed-43b9-4102-82d3-ad875fcff87c" alt="Double Pendulum Setup" width="300">
</p>

### Forces Acting on m<sub>1</sub>

The forces acting on m<sub>1</sub> are shown in the figure below:

<p align="center">
  <img src="https://github.com/user-attachments/assets/cdcf8a70-0630-4c61-b3e7-6a265c682c15" alt="Forces on m1" width="300">
</p>

The corresponding equations of motion for m<sub>1</sub> are:

<p align="center">
  <img src="https://github.com/user-attachments/assets/06df0483-fd15-4249-aa86-bc8866ce21d1" alt="Equations of Motion for m1" width="350">
</p>

### Forces Acting on m<sub>2</sub>

The forces acting on m<sub>2</sub> are shown in the figure below:

<p align="center">
  <img src="https://github.com/user-attachments/assets/5b95c3ee-4802-46c8-9e31-7feaecd01419" alt="Forces on m2" width="300">
</p>

The corresponding equations of motion for m<sub>2</sub> are:

<p align="center">
  <img src="https://github.com/user-attachments/assets/a7e3e1f4-8f4a-4563-bce3-f60f41d5d00d" alt="Equations of Motion for m2" width="350">
</p>

---

## Matrix Form and Simplifications

After performing the necessary transformations and simplifications, the equations for θ<sub>1</sub> and θ<sub>2</sub> can be written in matrix form as follows:

<p align="center">
  <img src="https://github.com/user-attachments/assets/fa6667ce-2e53-4893-9fa1-608f0d4aace5" alt="Matrix Form" width="400">
</p>

The detailed derivation of these equations is provided in the last section to demonstrate how the transformations and simplifications are applied step-by-step.

By multiplying with the inverse of the A matrix, the explicit equations for θ<sub>1</sub> and θ<sub>2</sub> are obtained:

<p align="center">
  <img src="https://github.com/user-attachments/assets/343fc51a-ea42-4cfb-84fc-8b3aae5ef430" alt="Explicit Equations" width="500">
</p>

---

## First-Order Differential Equations

To solve this set of equations using numerical methods, they are converted into a system of first-order differential equations:

<p align="center">
  <img src="https://github.com/user-attachments/assets/00f385ae-d037-43e9-9d9b-2b32862170de" alt="First Order System" width="425">
</p>

The system becomes:

<p align="center">
  <img src="https://github.com/user-attachments/assets/bceebe90-679f-4307-9ca5-89266bc548c3" alt="Expanded System" width="250">
</p>

Where the coefficient matrices are defined as:

<p align="center">
  <img src="https://github.com/user-attachments/assets/34667538-a89e-41b8-afc2-be86c39f2a78" alt="Coefficient Matrices" width="500">
</p>

---

## Initial Conditions

The physical values and initial conditions for the example solution are:

<p align="center">
  <img src="https://github.com/user-attachments/assets/eebe5fd5-afa0-4855-b79b-0ef32b998232" alt="Physical Values" width="400">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/a6adb2de-6684-42e9-93b5-6acbcd90f011" alt="Initial Conditions" width="400">
</p>

---

## Example Solution

Using the default values and solving with both the **RK4** method and MATLAB's **ode45** function, the following results are obtained:

<p align="center">
  <img src="https://github.com/user-attachments/assets/9be67253-9700-40fc-9973-8cf73a4157e5" alt="Example Solution" width="1000">
</p>

The animation generated by the **ode45** method is shown below:

https://github.com/user-attachments/assets/e8ca3182-2022-4dbe-a167-56a892e8f1ed

---

## Task

The task is to implement the **Runge-Kutta 4th Order (RK4)** method and MATLAB's built-in **ode45** function to solve the given set of differential equations with varying physical values and initial conditions. The goal is to observe how changes in these values affect the results and the behavior of the system.

---



## Derivation of the Equations

In this section, the derivation of the final equations are shown step by step.

#### Equations of Motion
The corresponding equations of motion for both masses are given below:

<p align="center">
  <img src="https://github.com/user-attachments/assets/06df0483-fd15-4249-aa86-bc8866ce21d1" alt="Equations of Motion for m1" width="350">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/a7e3e1f4-8f4a-4563-bce3-f60f41d5d00d" alt="Equations of Motion for m2" width="350">
</p>

#### Angular Transformations
The equations for m<sub>1</sub> are transformed into angular form by multiplying the x-direction equation by costheta1 and the y-direction equation by sintheta1. When these equations are added and simplified, they can be written in the following forms:

<img src="https://github.com/user-attachments/assets/8cdca029-eb9c-4067-986b-bd1f70ea7baf" alt="Time Period" width="400">

The same operations are performed for m<sub>2</sub> with costheta2 in the x-direction and sintheta2 in the y-direction equation:

<img src="https://github.com/user-attachments/assets/bc7c48cf-dd35-48bb-a1d7-87d4a2e4a7fb" alt="Time Period" width="400">

Thus, the dynamics can be expressed in terms of angular positions and velocities.

#### Coordinate Transformations
The Cartesian coordinates of the masses can be related to the angles theta1 and theta2 using the following relations:

<img src="https://github.com/user-attachments/assets/c92a89d3-a281-41f1-81d4-3e207867a732" alt="Time Period" width="400">


<img src="https://github.com/user-attachments/assets/47fa0874-2dee-4759-bba9-71fd1dda67c6" alt="Time Period" width="400">

#### Equations of Motion in Angular Form

To make the equations more simplified, a reduced mass term for the second bob is defined as follows:

<img src="https://github.com/user-attachments/assets/be192fdb-7941-4578-b735-3b071e7fb374" alt="Time Period" width="400">


After replacing the Cartesian coordinates (x1,y1,x2,y2) with appropriate forms in terms of theta1 and theta2, their equations of motion are obtained, respectively:

<img src="https://github.com/user-attachments/assets/60e0883a-ffee-4f67-984e-ff7dfe420466" alt="Time Period" width="400">

<img src="https://github.com/user-attachments/assets/f2fcefde-5dd8-4140-8a8d-d1b5fbc8f67d" alt="Time Period" width="400">

Finally, they can are written explicitly in the matrix form as follows:

<img src="https://github.com/user-attachments/assets/fa6667ce-2e53-4893-9fa1-608f0d4aace5" alt="Time Period" width="400">


